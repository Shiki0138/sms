// ğŸŒŸ ç¾å®¹å®¤ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µãƒ†ãƒ¼ãƒ–ãƒ«ç¾¤ - ãƒãƒ¼ãƒ Cå“è³ªå¼·åŒ–

// é¡§å®¢ãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ - ãŠå®¢æ§˜ã®å¥½ã¿ã‚’å®Œç’§ã«ç†è§£
model CustomerPreference {
  id               String   @id @default(cuid())
  customerId       String
  category         String   // 'service', 'staff', 'time', 'communication'
  preferenceValue  String
  confidenceScore  Float    @default(0.5)
  lastUpdated      DateTime @default(now())
  tenantId         String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  // Relations
  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  tenant   Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  // ç¾å®¹å®¤æ¥­å‹™æœ€é©åŒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  @@index([customerId])
  @@index([category])
  @@index([tenantId])
  @@index([customerId, category])
  @@map("customer_preferences")
}

// ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ - å£²ä¸Šå‘ä¸Šæˆ¦ç•¥
model MarketingCampaign {
  id             String   @id @default(cuid())
  name           String
  type           String   // 'email', 'sms', 'line', 'instagram'
  targetSegment  String?  // 'VIP', 'REGULAR', 'NEW', 'CHURNED'
  startDate      DateTime?
  endDate        DateTime?
  budget         Decimal? @default(0)
  conversionRate Float    @default(0.0)
  roi            Float    @default(0.0)
  tenantId       String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  // Relations
  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  // ç¾å®¹å®¤æ¥­å‹™æœ€é©åŒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  @@index([tenantId])
  @@index([startDate, endDate])
  @@index([targetSegment])
  @@index([tenantId, type])
  @@map("marketing_campaigns")
}

// ã‚¹ã‚¿ãƒƒãƒ•ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ - ç¾å®¹å¸«ã®æˆç¸¾è¦‹ãˆã‚‹åŒ–
model StaffPerformance {
  id                   String   @id @default(cuid())
  staffId              String
  month                DateTime
  appointmentsCount    Int      @default(0)
  revenueGenerated     Decimal  @default(0)
  customerSatisfaction Float    @default(0.0)
  upsellRate           Float    @default(0.0)
  repeatRate           Float    @default(0.0)
  avgServiceTime       Int      @default(0) // in minutes
  tenantId             String
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  // Relations
  staff  Staff  @relation("StaffPerformance", fields: [staffId], references: [id], onDelete: Cascade)
  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  // ç¾å®¹å®¤æ¥­å‹™æœ€é©åŒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  @@index([staffId])
  @@index([month])
  @@index([tenantId])
  @@index([staffId, month])
  @@unique([staffId, month])
  @@map("staff_performance")
}